export default function BigBrother(e,t){let n={},c={},o=document.getElementById(e.id);var r;return o=o||document.body,function e(t,n){for(const c in t)if(t.hasOwnProperty(c)){let o=t[c];const r=void 0===n?c:`${n}.${c}`;if(o instanceof Object&&void 0===n){e(o,r);continue}Object.defineProperty(t,c,{get:()=>o,set(e){o=e,a(r)}})}}(e.watchers),l("interpolate-for",null,(r=e).watchers,s),l("view-if",null,r.watchers,f),l("watch-text","textContent",r.watchers,h),l("watch-text","innerText",r.watchers,h),l("watch-value","value",r.watchers,h),l("watch-html","innerHTML",r.watchers,h),l("watch-class","className",r.watchers,h),l("watch-id","id",r.watchers,h),l("watch-name","name",r.watchers,h),l("listen-input","input",r,d),l("listen-click","click",r,d),l("listen-change","change",r,d),{el:o,data:e,watch:i};function i(e,t){n[e]||(n[e]=[]),n[e].push(t)}function a(e){!n[e]||n[e].length<1||n[e].forEach(e=>e.call())}function l(e,n,c,r){const i=o.querySelectorAll(`[${e}]`);for(const o of i){let i=o.attributes[e].value,a=i.split(".");if(t&&o.removeAttribute(e),1===a.length){r(c,i,o,n,i);continue}let l=a.shift(),s=Object.assign({},c);for(const e of a)s=s[l],l=e;r(s,l,o,n,i)}}function s(e,n,c){const o=c.parentNode,r=e[n],i=/\$\{key\}/g,a=/\$\{value\}/g;for(const e in r){let n=r[e],l=c.cloneNode(!0);for(let t of c.attributes){const c=t.nodeName,o=t.nodeValue.replace(i,e).replace(a,n);l.attributes[c].nodeValue=o}o.insertBefore(l,c),t&&l.removeAttribute("interpolate-for")}o.removeChild(c)}function f(e,t,n,c,o){u(e,t,n),i(o,()=>u(e,t,n))}function u(e,t,n){if(e[t]){const e=c[n];if(void 0===e)return;const t=e.parent,o=t.childNodes[e.index];t.insertBefore(n,o)}else{const e=n.parentNode,t=Array.from(e.children).indexOf(n);c[n]={index:t,parent:e},e.removeChild(n)}}function h(e,t,n,c,o){n[c]=e[t],i(o,()=>n[c]=e[t])}function d(e,t,n,c){n.addEventListener(c,n=>{!function(e,t,n){void 0===e.listeners[t]?e.watchers[t]=n.target.value:e.listeners[t].call(e,n)}(e,t,n)},!0)}}